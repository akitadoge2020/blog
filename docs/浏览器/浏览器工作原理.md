# 浏览器工作原理

> 参考链接：[你不知道的浏览器渲染原理（图文并茂，8000字深度解读）](https://mp.weixin.qq.com/s/9vSol8ggf4_OZLGGiKQcpQ)

在深入了解浏览器工作原理之前，需要先了解几个概念。

## 概念

### JS、JS执行引擎和浏览器

- JS：一门计算机语言，提供了表达程序逻辑的语法和实现基本功能的API
- JS执行引擎：宿主环境的一个功能模块，负责解析执行JS代码
- 浏览器：JS代码的运行环境，也称之为宿主环境

它们的关系如图：

![image-20220503154622020](https://penguinbucket.obs.cn-southwest-2.myhuaweicloud.com/img/image-20220503154622020.png)

### 进程和线程

- 进程：是操作系统分配资源的基本单位，**简单来说，进程可以理解为一个正在运行的应用程序**。在一个应用程序运行时，需要使用内存和CPU资源，这些资源需要向操作系统申请，操作系统会以进程为单位分配这些资源。一个应用程序要运行，就至少要有一个进程启动。**一个进程就代表着一块独立于其他进程的内存空间**。进程最大的特点就是独立，一个进程不能随意访问其他进程的资源，这就保证了多个程序在操作系统上运行互不干扰。

![image-20220503161911961](https://penguinbucket.obs.cn-southwest-2.myhuaweicloud.com/img/image-20220503161911961.png)

- 线程：是进程的一个执行单位，也就是说，**线程是跑在进程里面的**。一个进程里可能有一个或多个线程，而一个线程只能隶属于一个进程。线程和线程之间相互独立，但可以共享资源。

![image-20220503162941766](https://penguinbucket.obs.cn-southwest-2.myhuaweicloud.com/img/image-20220503162941766.png)

## 浏览器的多进程架构

在应用程序中，为了满足功能需要，启动的进程会创建另一个新的进程来处理其他任务，这些被创建出来的进程一样拥有独立的内存空间，与原来的进程互不干扰。如果这些进程之间需要通信，可以通过IPC机制（Inter Process Communication）来进行。

![image-20220503163949888](https://penguinbucket.obs.cn-southwest-2.myhuaweicloud.com/img/image-20220503163949888.png)

不同的浏览器使用不同的架构，它可以是单进程多线程应用程序，也可以是基于IPC通信的多线程应用程序。

我们主要以Chrome为例，介绍浏览器的多进程架构。

在Chrome中，主要的进程有4个：

- 浏览器进程 (Browser Process)：负责浏览器的TAB的前进、后退、地址栏、书签栏的工作和处理浏览器的一些不可见的底层操作，比如网络请求和文件访问。
- 渲染进程 (Renderer Process)：负责一个Tab内的显示相关的工作，也称渲染引擎。
- 插件进程 (Plugin Process)：负责控制网页使用到的插件
- GPU进程 (GPU Process)：负责处理整个应用程序的GPU任务

