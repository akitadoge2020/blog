(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{562:function(t,s,a){"use strict";a.r(s);var e=a(17),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"热替换"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#热替换"}},[t._v("#")]),t._v(" 热替换")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("热替换并不能降低构建时间（可能还会稍微增加），但可以降低代码改动到效果呈现的时间。")])]),t._v(" "),a("p",[t._v("当使用"),a("code",[t._v("webpack-dev-server")]),t._v("时，代码改动到效果呈现的过程：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://penguinbucket.obs.cn-southwest-2.myhuaweicloud.com/img/image-20220715104704805.png",alt:"image-20220715104704805"}})]),t._v(" "),a("p",[t._v("而使用了热替换后，流程发生了变化：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://penguinbucket.obs.cn-southwest-2.myhuaweicloud.com/img/image-20220715104743181.png",alt:"image-20220715104743181"}})]),t._v(" "),a("h2",{attrs:{id:"使用和原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用和原理"}},[t._v("#")]),t._v(" 使用和原理")]),t._v(" "),a("ol",[a("li",[t._v("更改配置")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("devServer")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("hot")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 开启HMR")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("plugins")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 可选")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("webpack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HotModuleReplacementPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("更改代码")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// index.js")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否开启了热更新")]),t._v("\n  module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("accept")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 接受热更新")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[t._v("首先，这段代码会参与最终运行！")]),t._v(" "),a("p",[t._v("当开启了热更新后，"),a("code",[t._v("webpack-dev-server")]),t._v("会向打包结果中注入"),a("code",[t._v("module.hot")]),t._v("属性。")]),t._v(" "),a("p",[t._v("默认情况下，"),a("code",[t._v("webpack-dev-server")]),t._v("不管是否开启了热更新，当重新打包后，都会调用"),a("code",[t._v("location.reload")]),t._v("刷新页面。")]),t._v(" "),a("p",[t._v("但如果运行了"),a("code",[t._v("module.hot.accept()")]),t._v("，将改变这一行为。")]),t._v(" "),a("p",[a("code",[t._v("module.hot.accept()")]),t._v("的作用是让"),a("code",[t._v("webpack-dev-server")]),t._v("通过"),a("code",[t._v("socket")]),t._v("管道，把服务器更新的内容发送到浏览器。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://penguinbucket.obs.cn-southwest-2.myhuaweicloud.com/img/image-20220715130051721.png",alt:"image-20220715130051721"}})]),t._v(" "),a("p",[t._v("然后，将结果交给插件"),a("code",[t._v("HotModuleReplacementPlugin")]),t._v("注入的代码执行")]),t._v(" "),a("p",[t._v("插件"),a("code",[t._v("HotModuleReplacementPlugin")]),t._v("会根据覆盖原始代码，然后让代码重新执行")]),t._v(" "),a("p",[a("strong",[t._v("所以，热替换发生在代码运行期")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"样式热替换"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#样式热替换"}},[t._v("#")]),t._v(" 样式热替换")]),t._v(" "),a("p",[t._v("对于样式也是可以使用热替换的，但需要使用"),a("code",[t._v("style-loader")]),t._v("。")]),t._v(" "),a("p",[t._v("因为热替换发生时，"),a("code",[t._v("HotModuleReplacementPlugin")]),t._v("只会简单的重新运行模块代码。")]),t._v(" "),a("p",[t._v("因此"),a("code",[t._v("style-loader")]),t._v("的代码一运行，就会重新设置"),a("code",[t._v("style")]),t._v("元素中的样式。")]),t._v(" "),a("p",[t._v("而"),a("code",[t._v("mini-css-extract-plugin")]),t._v("，由于它生成文件是在"),a("strong",[t._v("构建期间")]),t._v("，运行期间并会也无法改动文件，因此它对于热替换是无效的。")]),t._v(" "),a("Vssue",{attrs:{options:{labels:[t.$page.relativePath.split("/")[0]]},title:t.$page.relativePath.split("/")[1]}})],1)}),[],!1,null,null,null);s.default=n.exports}}]);